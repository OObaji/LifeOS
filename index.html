<!DOCTYPE html>
<html lang="en" class="overflow-x-hidden">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LifeOS - Second Brain</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        zinc: {
                            850: '#1f1f22',
                            950: '#09090b',
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            -webkit-font-smoothing: antialiased; 
            touch-action: manipulation;
        }
        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #52525b; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #71717a; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake {
            animation: shake 0.2s ease-in-out 2;
        }
        .landing-gradient {
            background: linear-gradient(135deg, #09090b 0%, #18181b 100%);
        }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-100 min-h-screen overflow-y-auto">
    <div id="root"></div>

    <!-- Application Logic -->
    <script type="module">
        import React, { useState, useEffect, useRef } from "https://esm.sh/react@18.2.0";
        import { createRoot } from "https://esm.sh/react-dom@18.2.0/client";
        import { 
            Layout, Home, BookOpen, Target, PenTool, Settings, Search, Bell, Plus, 
            MoreHorizontal, CheckCircle2, Clock, ArrowRight, Brain, Layers, 
            Calendar as CalendarIcon, ChevronRight, Sun, Moon, Filter, Zap, Coffee, 
            Video, MapPin, RefreshCw, MoreVertical, Lightbulb, Sparkles, Trash2, 
            Sprout, Briefcase, DollarSign, Move, Eraser, Palette, MousePointer2, 
            Trophy, Flag, TrendingUp, Award, Crosshair, Star, Bookmark, Book, 
            GraduationCap, Wallet, Building, Users, ExternalLink, Link as LinkIcon, 
            PlayCircle, Film, Music, Gamepad2, MonitorPlay, Headphones, Tv, 
            MessageSquare, AlertCircle, Folder, Minus, CalendarDays, LogOut, Lock, 
            Fingerprint, Delete, KeyRound, ShieldQuestion, RotateCcw, Menu, X, Save, Edit3, Wifi, WifiOff, Database,
            Timer, Play, Pause, Wrench, File, CreditCard, Coins, Heart, Activity, Scissors, Share2, Mail, Archive, Image,
            Cloud, CloudRain, CloudSun, CloudSnow, CloudLightning, Thermometer,
            List, Grid, Columns, Utensils, FileText, Trash, ShieldAlert, Flame, Volume2, ChevronLeft,
            ListTodo, ArrowUpRight, CheckSquare, Flower2, Dumbbell, Github, Bot, Newspaper, QrCode,
            Waves, Wind, Mountain, Footprints, Ban, ShieldCheck, Milestone, User, LogIn, ArrowLeft, Info,
            Eye, EyeOff
        } from "https://esm.sh/lucide-react@0.344.0?deps=react@18.2.0";

        // --- FIREBASE IMPORTS ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { 
            getAuth, 
            signInWithCustomToken, 
            signInAnonymously, 
            onAuthStateChanged, 
            signOut,
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword,
            GoogleAuthProvider,
            signInWithPopup
        } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, addDoc, updateDoc, deleteDoc, query, orderBy, serverTimestamp, setDoc, getDoc, writeBatch } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // --- CONFIGURATION ---
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "", 
            authDomain: "secondbrain-8d8cd.firebaseapp.com",
            projectId: "secondbrain-8d8cd",
            storageBucket: "secondbrain-8d8cd.firebasestorage.app",
            messagingSenderId: "1913632272",
            appId: "1:1913632272:web:324f366a35e6dd07cffc95"
        };
        
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'kaizen-os-prod';
        
        // Initialize Firebase
        let app, auth, db;
        let isFirebaseConfigured = false;
        
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            isFirebaseConfigured = true;
        } catch (e) {
            console.warn("Firebase Init Error:", e);
        }

        // --- LOCAL AUTH SIMULATION ---
        const LocalAuth = {
            login: (email, password) => {
                const users = JSON.parse(localStorage.getItem('lifeos_local_db_users') || '{}');
                const user = users[email.toLowerCase()];
                if (!user) throw new Error("User not found locally. Please create an account.");
                if (user.password !== password) throw new Error("Incorrect password.");
                return { email: user.email, uid: user.uid, isLocal: true };
            },
            signup: (email, password) => {
                const users = JSON.parse(localStorage.getItem('lifeos_local_db_users') || '{}');
                if (users[email.toLowerCase()]) throw new Error("Account already exists. Please sign in.");
                
                const uid = 'local_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                users[email.toLowerCase()] = { email, password, uid };
                localStorage.setItem('lifeos_local_db_users', JSON.stringify(users));
                
                return { email, uid, isLocal: true };
            }
        };

        // --- DATA CONSTANTS ---
        const DEFAULT_MEALS = [
            { day: 'Monday', type: 'Breakfast', text: 'Oats + milk\n1 banana\n1 scoop protein powder' },
            { day: 'Monday', type: 'Lunch', text: 'Chicken stew\nWhite rice\n½ avocado' },
            { day: 'Monday', type: 'Snack', text: 'Greek yoghurt + apple' },
            { day: 'Monday', type: 'Dinner', text: 'Spaghetti + grilled chicken breast\n(Night: Milo + milk)' },
            { day: 'Tuesday', type: 'Breakfast', text: '3 eggs (boiled/scrambled)\nBread + peanut butter\nGrapes' },
            { day: 'Tuesday', type: 'Lunch', text: 'Jollof rice\nChicken thigh' },
            { day: 'Tuesday', type: 'Snack', text: 'Protein shake' },
            { day: 'Tuesday', type: 'Dinner', text: 'Sardines\nBoiled potatoes' },
            { day: 'Wednesday', type: 'Breakfast', text: 'Cereal + milk\nBanana' },
            { day: 'Wednesday', type: 'Lunch', text: 'Chicken breast\nRice\nAvocado' },
            { day: 'Wednesday', type: 'Snack', text: 'Greek yoghurt + grapes' },
            { day: 'Wednesday', type: 'Dinner', text: 'Spaghetti + chicken stew' },
            { day: 'Thursday', type: 'Breakfast', text: 'Oats + milk\nApple\n1 scoop protein' },
            { day: 'Thursday', type: 'Lunch', text: 'Chicken stew\nRice' },
            { day: 'Thursday', type: 'Snack', text: 'Bread + peanut butter' },
            { day: 'Thursday', type: 'Dinner', text: 'Sardines\nPotatoes' },
            { day: 'Friday', type: 'Breakfast', text: '3 eggs\nBread + jam\nBanana' },
            { day: 'Friday', type: 'Lunch', text: 'Jollof rice\nChicken breast' },
            { day: 'Friday', type: 'Snack', text: 'Greek yoghurt' },
            { day: 'Friday', type: 'Dinner', text: 'Pasta + grilled chicken thigh' },
            { day: 'Saturday', type: 'Breakfast', text: 'Cereal + milk\nGrapes' },
            { day: 'Saturday', type: 'Lunch', text: 'Chicken thigh\nRice + avocado' },
            { day: 'Saturday', type: 'Snack', text: 'Protein shake' },
            { day: 'Saturday', type: 'Dinner', text: 'Eggs (omelette)\nBread' },
            { day: 'Sunday', type: 'Breakfast', text: 'Oats + milk\nBanana' },
            { day: 'Sunday', type: 'Lunch', text: 'Rice + sardines' },
            { day: 'Sunday', type: 'Snack', text: 'Greek yoghurt + apple' },
            { day: 'Sunday', type: 'Dinner', text: 'Chicken stew\nPotatoes' }
        ];

        const WORKOUT_PLAN = [
            { id: 'day1', title: "Day 1 – Chest & Triceps", icon: Flame, color: "text-orange-500", warmup: ["Light DB presses – 15 reps", "Arm circles"], exercises: [{ name: "DB Floor Press", sets: "4", reps: "8–12" }, { name: "DB Chest Fly", sets: "3", reps: "10–15" }, { name: "Neutral-grip DB Press", sets: "3", reps: "8–12" }, { name: "Overhead DB Tri Ext", sets: "3", reps: "10–15" }], finisher: "DB Floor Press hold – 3 × 30s" },
            { id: 'day2', title: "Day 2 – Legs (DB Only)", icon: Activity, color: "text-blue-500", warmup: ["Bodyweight squats – 20", "Leg swings"], exercises: [{ name: "Goblet Squats", sets: "4", reps: "10–15" }, { name: "DB RDLs", sets: "4", reps: "8–12" }, { name: "Walking Lunges", sets: "3", reps: "10/leg" }, { name: "DB Step-Ups", sets: "3", reps: "10/leg" }], finisher: "Goblet squat hold – 2 rounds" },
            { id: 'day3', title: "Day 3 – Shoulders & Arms", icon: Dumbbell, color: "text-emerald-500", warmup: ["Light DB raises", "Arm swings"], exercises: [{ name: "Seated DB Press", sets: "4", reps: "8–12" }, { name: "DB Lateral Raises", sets: "4", reps: "12–15" }, { name: "DB Front Raises", sets: "3", reps: "12" }, { name: "Alt DB Curls", sets: "3", reps: "10–12" }], finisher: "Lateral raise partials – 2 × 30s" },
            { id: 'day4', title: "Day 4 – Arms + Chest Pump", icon: Zap, color: "text-purple-500", subtitle: "Short, intense.", warmup: [], exercises: [{ name: "DB Floor Press", sets: "4", reps: "12–15" }, { name: "Squeeze Press", sets: "3", reps: "12" }, { name: "Concentration Curls", sets: "3", reps: "10/arm" }, { name: "21s DB Curls", sets: "2", reps: "rounds" }], finisher: "Curl → press combo" }
        ];

        const BIBLE_TOPICS = [
            { title: "Finance & Wealth", desc: "Stewardship & trust.", verses: ["Prov 22:7", "Matt 6:24"], chapters: ["Prov 3", "Matt 6"] },
            { title: "Overcoming Lust", desc: "Purity & self-control.", verses: ["2 Tim 2:22", "1 Cor 6:18"], chapters: ["Rom 6", "Ps 51"] },
            { title: "Power of Prayer", desc: "Communion with God.", verses: ["Phil 4:6", "1 Thess 5:17"], chapters: ["Luke 11", "Ps 145"] },
            { title: "Anxiety & Peace", desc: "Finding rest.", verses: ["1 Pet 5:7", "John 14:27"], chapters: ["Phil 4", "Ps 23"] },
            { title: "Diligence", desc: "Work unto the Lord.", verses: ["Col 3:23", "Prov 13:4"], chapters: ["Prov 6", "Eccl 3"] }
        ];

        const FOCUS_SOUNDS = [
            { id: 'rain', label: 'Rain', icon: CloudRain, url: 'https://assets.mixkit.co/active_storage/sfx/2515/2515-preview.mp3' },
            { id: 'forest', label: 'Forest', icon: CloudSun, url: 'https://assets.mixkit.co/active_storage/sfx/2511/2511-preview.mp3' },
            { id: 'fire', label: 'Fire', icon: Flame, url: 'https://assets.mixkit.co/active_storage/sfx/2513/2513-preview.mp3' },
            { id: 'cafe', label: 'Cafe', icon: Coffee, url: 'https://assets.mixkit.co/active_storage/sfx/96/96-preview.mp3' },
            { id: 'lofi', label: 'Lofi', icon: Music, url: 'https://cdn.pixabay.com/audio/2022/11/22/audio_febc508520.mp3' },
            { id: 'ocean', label: 'Ocean', icon: Waves, url: 'https://assets.mixkit.co/active_storage/sfx/1126/1126-preview.mp3' },
            { id: 'thunder', label: 'Thunder', icon: CloudLightning, url: 'https://assets.mixkit.co/active_storage/sfx/2507/2507-preview.mp3' }
        ];

        const DAILY_SPIRITUALITY = [
            { verse: "Joshua 1:9", text: "Be strong and courageous...", prayer: "Lord, grant me courage.", encouragement: "You are never alone." },
            { verse: "Jer 29:11", text: "Plans to prosper you...", prayer: "Help me trust Your timing.", encouragement: "Your future is bright." },
            { verse: "Isa 40:31", text: "Renew their strength...", prayer: "Renew my strength, Lord.", encouragement: "God is strengthening you." },
            { verse: "Rom 8:28", text: "All things work for good...", prayer: "Thank You for Your plan.", encouragement: "Setbacks are setups." },
            { verse: "Ps 46:10", text: "Be still...", prayer: "Quiet my thoughts.", encouragement: "Peace is His presence." }
        ];

        const BIBLE_BOOKS = [
            { category: "Foundations", books: [{ name: "Genesis", theme: "Beginnings", app: "Family & Legacy", keys: "Gen 1" }, { name: "Proverbs", theme: "Wisdom", app: "Finance & Habits", keys: "Prov 3" }] },
            { category: "Leadership", books: [{ name: "Joshua", theme: "Conquest", app: "Courage", keys: "Josh 1" }, { name: "Nehemiah", theme: "Rebuilding", app: "Management", keys: "Neh 1" }] },
            { category: "Gospels", books: [{ name: "Matthew", theme: "King", app: "Ethics", keys: "Matt 5" }, { name: "John", theme: "God", app: "Identity", keys: "John 1" }] },
            { category: "Letters", books: [{ name: "Romans", theme: "Gospel", app: "Mindset", keys: "Rom 8" }, { name: "James", theme: "Action", app: "Integrity", keys: "Jas 1" }] }
        ];

        // --- HELPERS ---
        const Card = ({ children, className = "", title, action }) => (
            React.createElement("div", { className: `bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-4 md:p-6 flex flex-col ${className}` },
                (title || action) && (
                    React.createElement("div", { className: "flex justify-between items-center mb-4" },
                        title && React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider" }, title),
                        action
                    )
                ),
                children
            )
        );

        const NavItem = ({ icon: Icon, label, active, onClick }) => (
            React.createElement("button", { 
                onClick: onClick,
                className: `w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${active ? 'bg-zinc-900 text-white dark:bg-white dark:text-zinc-900 shadow-lg shadow-zinc-200 dark:shadow-none' : 'text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800'}`
            },
                React.createElement(Icon, { size: 20, className: active ? '' : 'stroke-[2px]' }),
                React.createElement("span", { className: "font-medium" }, label),
                active && React.createElement(ChevronRight, { size: 16, className: "ml-auto opacity-50" })
            )
        );

        const QuickLinkButton = ({ href, icon: Icon, label, colorClass = "text-zinc-600 dark:text-zinc-300" }) => (
            React.createElement("a", { href: href, target: "_blank", rel: "noopener noreferrer", className: "flex flex-col items-center justify-center gap-2 p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950/50 border border-zinc-100 dark:border-zinc-800 hover:border-indigo-500/50 hover:bg-white dark:hover:bg-zinc-900 hover:shadow-md transition-all group text-center h-full" },
                React.createElement("div", { className: `w-8 h-8 rounded-full flex items-center justify-center bg-white dark:bg-zinc-900 shadow-sm group-hover:scale-110 transition-transform ${colorClass}` }, React.createElement(Icon, { size: 16 })),
                React.createElement("span", { className: "text-xs font-medium text-zinc-600 dark:text-zinc-400 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 line-clamp-1" }, label)
            )
        );

        // --- AUTH COMPONENT ---
        const AuthModal = ({ onClose, onLogin }) => {
            const [activeTab, setActiveTab] = useState("login"); // 'login' or 'signup'
            const [email, setEmail] = useState("");
            const [password, setPassword] = useState("");
            const [confirmPassword, setConfirmPassword] = useState("");
            const [showPassword, setShowPassword] = useState(false);
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(false);

            const isLogin = activeTab === "login";

            const handleSubmit = async (e) => {
                e.preventDefault(); setError(null); setLoading(true);
                
                if (!isLogin && password !== confirmPassword) {
                    setError("Passwords do not match."); setLoading(false); return;
                }

                try {
                    // Try real Firebase Auth first
                    if (isLogin) await signInWithEmailAndPassword(auth, email, password);
                    else await createUserWithEmailAndPassword(auth, email, password);
                    onLogin({ email, uid: auth.currentUser.uid, isLocal: false });
                    onClose();
                } catch (err) { 
                    console.warn("Auth Error caught, triggering fallback...");
                    let msg = err.message.replace("Firebase: ", "");
                    
                    // FALLBACK TO LOCAL AUTH
                    // This catches everything: network errors, unauthorized domains, user not found, etc.
                    try {
                        const localUser = isLogin 
                            ? LocalAuth.login(email, password)
                            : LocalAuth.signup(email, password);
                        onLogin(localUser);
                        onClose();
                        return;
                    } catch (localErr) {
                         // Show local logic errors (e.g. "User not found locally", "Incorrect password")
                         setError(localErr.message); 
                    }
                } finally { setLoading(false); }
            };

            const handleGoogleLogin = async () => {
                setError(null); setLoading(true);
                try {
                    const provider = new GoogleAuthProvider();
                    provider.setCustomParameters({ prompt: 'select_account' });
                    await signInWithPopup(auth, provider);
                    onLogin({ email: auth.currentUser.email, uid: auth.currentUser.uid, isLocal: false });
                    onClose();
                } catch (err) { 
                    console.error("Google Auth Error:", err);
                    if (err.code === 'auth/unauthorized-domain' || err.code === 'auth/operation-not-allowed') {
                         // PREVIEW FALLBACK for Google
                        setError("⚠️ Google Sign-In not authorized in preview. Works on deployed site.");
                    } else if (err.code === 'auth/popup-closed-by-user') {
                        setError("Sign in cancelled.");
                    } else {
                        setError("Google Sign-In failed.");
                    }
                } finally { setLoading(false); }
            };

            return React.createElement("div", { className: "fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200" },
                React.createElement("div", { className: "bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-8 max-w-sm w-full relative shadow-2xl" },
                    React.createElement("button", { onClick: onClose, className: "absolute top-4 right-4 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200" }, React.createElement(X, { size: 20 })),
                    
                    // Header with Tabs
                    React.createElement("div", { className: "text-center mb-6" },
                        React.createElement("div", { className: "w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 flex items-center justify-center mx-auto mb-3" }, React.createElement(LogIn, { size: 24 })),
                        React.createElement("div", { className: "flex justify-center gap-4 border-b border-zinc-100 dark:border-zinc-800 pb-2 mt-4" },
                            React.createElement("button", { onClick: () => { setActiveTab("login"); setError(null); }, className: `pb-2 text-sm font-bold transition-colors ${isLogin ? 'text-indigo-600 border-b-2 border-indigo-600' : 'text-zinc-400 hover:text-zinc-600'}` }, "Sign In"),
                            React.createElement("button", { onClick: () => { setActiveTab("signup"); setError(null); }, className: `pb-2 text-sm font-bold transition-colors ${!isLogin ? 'text-indigo-600 border-b-2 border-indigo-600' : 'text-zinc-400 hover:text-zinc-600'}` }, "Create Account")
                        )
                    ),

                    React.createElement("div", { className: "space-y-4" },
                        React.createElement("button", { onClick: handleGoogleLogin, className: "w-full py-3 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-700 text-zinc-700 dark:text-zinc-200 font-bold rounded-xl transition-colors flex items-center justify-center gap-2" }, 
                            React.createElement("img", { src: "https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg", className: "w-5 h-5", alt: "G" }), "Sign in with Google"
                        ),
                        React.createElement("div", { className: "relative flex py-2 items-center" }, React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" }), React.createElement("span", { className: "flex-shrink mx-4 text-xs text-zinc-400 uppercase" }, "Or"), React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" })),
                        React.createElement("form", { onSubmit: handleSubmit, className: "space-y-4" },
                            React.createElement("input", { type: "email", required: true, value: email, onChange: (e) => setEmail(e.target.value), placeholder: "Email", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100" }),
                            
                            // Password Field with Toggle
                            React.createElement("div", { className: "relative" },
                                React.createElement("input", { type: showPassword ? "text" : "password", required: true, value: password, onChange: (e) => setPassword(e.target.value), placeholder: "Password", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100 pr-10" }),
                                React.createElement("button", { type: "button", onClick: () => setShowPassword(!showPassword), className: "absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200" }, React.createElement(showPassword ? EyeOff : Eye, { size: 18 }))
                            ),

                            !isLogin && React.createElement("input", { type: "password", required: true, value: confirmPassword, onChange: (e) => setConfirmPassword(e.target.value), placeholder: "Confirm Password", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-zinc-900 dark:text-zinc-100" }),
                            
                            error && React.createElement("div", { className: "p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg flex items-center gap-2" }, React.createElement(AlertCircle, { size: 16 }), error),
                            
                            React.createElement("button", { type: "submit", disabled: loading, className: "w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-colors disabled:opacity-50" }, loading ? "Processing..." : (isLogin ? "Sign In" : "Create Account"))
                        )
                    ),
                    React.createElement("div", { className: "mt-4 text-center" }, React.createElement("button", { onClick: () => { setIsLogin(!isLogin); setError(null); setConfirmPassword(""); }, className: "text-xs text-zinc-500 hover:text-indigo-500 hover:underline" }, isLogin ? "Need an account? Sign up" : "Already have an account? Sign in"))
                )
            );
        };

        // --- LANDING PAGE ---
        const LandingPage = ({ onLoginSuccess, onGuestLogin }) => {
            const [activeTab, setActiveTab] = useState("login"); // 'login' or 'signup'
            const [email, setEmail] = useState("");
            const [password, setPassword] = useState("");
            const [confirmPassword, setConfirmPassword] = useState("");
            const [showPassword, setShowPassword] = useState(false);
            const [error, setError] = useState(null);
            const [loading, setLoading] = useState(false);

            const isLogin = activeTab === "login";

            const handleSubmit = async (e) => {
                e.preventDefault(); setError(null); setLoading(true);
                if (!isLogin && password !== confirmPassword) { setError("Passwords do not match."); setLoading(false); return; }

                try {
                    if (isLogin) await signInWithEmailAndPassword(auth, email, password);
                    else await createUserWithEmailAndPassword(auth, email, password);
                    onLoginSuccess({ email, uid: auth.currentUser.uid, isLocal: false });
                } catch (err) { 
                    console.warn("Auth Fallback (Landing):", err.code);
                    try {
                         const localUser = isLogin 
                             ? LocalAuth.login(email, password)
                             : LocalAuth.signup(email, password);
                         onLoginSuccess(localUser);
                         return;
                     } catch (localErr) {
                         setError(localErr.message);
                         setLoading(false);
                         return;
                     }
                } finally { setLoading(false); }
            };

            const handleGoogleLogin = async () => {
                setError(null); setLoading(true);
                try {
                    const provider = new GoogleAuthProvider();
                    provider.setCustomParameters({ prompt: 'select_account' });
                    await signInWithPopup(auth, provider);
                    onLoginSuccess({ email: auth.currentUser.email, uid: auth.currentUser.uid, isLocal: false });
                } catch (err) { 
                    console.error("Google Auth Error:", err);
                    if (err.code === 'auth/unauthorized-domain' || err.code === 'auth/operation-not-allowed') {
                         setError("⚠️ Google Sign-In is disabled in this preview environment. Please use Email/Password.");
                    } else if (err.code === 'auth/popup-closed-by-user') {
                        setError("Sign in cancelled.");
                    } else {
                        setError("Google Sign-In failed.");
                    }
                } finally { setLoading(false); }
            };

            const handleGuest = () => {
                 onGuestLogin({ email: "Guest User", uid: "guest-user", isLocal: true });
            };

            return React.createElement("div", { className: "min-h-screen flex flex-col md:flex-row bg-zinc-950 text-white font-sans" },
                React.createElement("div", { className: "md:w-1/2 p-12 flex flex-col justify-between landing-gradient relative overflow-hidden" },
                    React.createElement("div", { className: "relative z-10" },
                        React.createElement("div", { className: "flex items-center gap-3 mb-8" },
                            React.createElement("div", { className: "w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center" }, React.createElement(Brain, { size: 24, className: "text-white" })),
                            React.createElement("h1", { className: "text-2xl font-bold tracking-tight" }, "LifeOS")
                        ),
                        React.createElement("h2", { className: "text-5xl md:text-6xl font-bold mb-6 leading-tight" }, "Your Second", React.createElement("br"), React.createElement("span", { className: "text-indigo-500" }, "Brain.")),
                        React.createElement("p", { className: "text-zinc-400 text-lg max-w-md leading-relaxed" }, "Organize your entire life. Master your habits. Achieve your 2026 vision. All in one place.")
                    ),
                    React.createElement("div", { className: "relative z-10 mt-12 grid grid-cols-2 gap-6" },
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-emerald-500" }), "Goal Tracking"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-blue-500" }), "Focus Timer"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-amber-500" }), "Daily Journal"),
                        React.createElement("div", { className: "flex items-center gap-3 text-zinc-300" }, React.createElement(CheckCircle2, { className: "text-indigo-500" }), "Habit Builder")
                    ),
                    React.createElement("div", { className: "absolute top-0 right-0 w-96 h-96 bg-indigo-600/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2" }),
                    React.createElement("div", { className: "absolute bottom-0 left-0 w-64 h-64 bg-rose-600/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2" })
                ),
                React.createElement("div", { className: "md:w-1/2 bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100 flex flex-col justify-center p-8 md:p-16" },
                    React.createElement("div", { className: "max-w-md w-full mx-auto" },
                        React.createElement("div", { className: "mb-8 text-center" },
                            React.createElement("h3", { className: "text-3xl font-bold mb-2" }, "Welcome"),
                            React.createElement("div", { className: "flex justify-center gap-6 border-b border-zinc-200 dark:border-zinc-800 pb-1 mt-4" },
                                React.createElement("button", { onClick: () => { setActiveTab("login"); setError(null); }, className: `pb-2 text-sm font-bold transition-colors border-b-2 ${isLogin ? 'text-indigo-600 border-indigo-600' : 'text-zinc-400 border-transparent hover:text-zinc-600'}` }, "Sign In"),
                                React.createElement("button", { onClick: () => { setActiveTab("signup"); setError(null); }, className: `pb-2 text-sm font-bold transition-colors border-b-2 ${!isLogin ? 'text-indigo-600 border-indigo-600' : 'text-zinc-400 border-transparent hover:text-zinc-600'}` }, "Create Account")
                            )
                        ),
                        
                        React.createElement("div", { className: "space-y-4" },
                             React.createElement("button", { onClick: handleGoogleLogin, disabled: loading, className: "w-full py-3 mb-2 bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 hover:bg-zinc-50 dark:hover:bg-zinc-700 text-zinc-700 dark:text-zinc-200 font-bold rounded-xl transition-all flex items-center justify-center gap-3 shadow-sm" },
                                React.createElement("img", { src: "https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg", className: "w-5 h-5", alt: "G" }), "Continue with Google"
                            ),
                            React.createElement("div", { className: "relative flex py-2 items-center mb-2" },
                                React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" }),
                                React.createElement("span", { className: "flex-shrink mx-4 text-xs text-zinc-400 uppercase font-bold tracking-wider" }, "Or with Email"),
                                React.createElement("div", { className: "flex-grow border-t border-zinc-200 dark:border-zinc-800" })
                            ),

                            React.createElement("form", { onSubmit: handleSubmit, className: "space-y-4" },
                                React.createElement("div", null, React.createElement("label", { className: "block text-xs font-bold text-zinc-500 uppercase mb-1 ml-1" }, "Email Address"), React.createElement("input", { type: "email", required: true, value: email, onChange: (e) => setEmail(e.target.value), placeholder: "name@example.com", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all text-zinc-900 dark:text-zinc-100" })),
                                
                                // Password Field with Toggle
                                React.createElement("div", null,
                                    React.createElement("label", { className: "block text-xs font-bold text-zinc-500 uppercase mb-1 ml-1" }, "Password"),
                                    React.createElement("div", { className: "relative" },
                                        React.createElement("input", { type: showPassword ? "text" : "password", required: true, value: password, onChange: (e) => setPassword(e.target.value), placeholder: "••••••••", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all text-zinc-900 dark:text-zinc-100 pr-10" }),
                                        React.createElement("button", { type: "button", onClick: () => setShowPassword(!showPassword), className: "absolute right-3 top-1/2 -translate-y-1/2 text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200" }, React.createElement(showPassword ? EyeOff : Eye, { size: 18 }))
                                    )
                                ),

                                !isLogin && React.createElement("div", null, React.createElement("label", { className: "block text-xs font-bold text-zinc-500 uppercase mb-1 ml-1" }, "Confirm Password"), React.createElement("input", { type: "password", required: true, value: confirmPassword, onChange: (e) => setConfirmPassword(e.target.value), placeholder: "••••••••", className: "w-full p-3 rounded-xl bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 transition-all text-zinc-900 dark:text-zinc-100" })),
                                
                                error && React.createElement("div", { className: "p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg flex items-center gap-2" }, React.createElement(AlertCircle, { size: 16 }), error),
                                
                                React.createElement("button", { type: "submit", disabled: loading, className: "w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed mt-2" }, loading ? "Processing..." : (isLogin ? "Sign In" : "Create Account"))
                            ),
                            React.createElement("div", { className: "mt-6 text-center" },
                                React.createElement("button", { onClick: handleGuest, disabled: loading, className: "text-xs text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors uppercase tracking-wider font-bold" }, "Continue as Guest")
                            )
                        )
                    )
                )
            );
        };

        // --- WIDGETS ---
        const WeatherWidget = () => {
            const [weather, setWeather] = useState(null);
            useEffect(() => {
                const fetchWeather = async (lat, lon) => {
                    try {
                        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code`);
                        const data = await res.json(); setWeather(data);
                    } catch(e) {}
                };
                if (navigator.geolocation) navigator.geolocation.getCurrentPosition(p => fetchWeather(p.coords.latitude, p.coords.longitude), () => fetchWeather(53.48, -2.24));
                else fetchWeather(53.48, -2.24);
            }, []);
            if (!weather) return React.createElement("div", { className: "animate-pulse h-10 w-24 bg-zinc-100 dark:bg-zinc-800 rounded" });
            return React.createElement("div", { className: "flex flex-col items-end" }, 
                React.createElement("span", { className: "text-xl font-bold" }, `${Math.round(weather.current.temperature_2m)}°C`),
                React.createElement("span", { className: "text-xs text-zinc-500" }, "Local Area")
            );
        };

        const TimeWidget = () => {
            const [time, setTime] = useState(new Date());
            useEffect(() => { const t = setInterval(() => setTime(new Date()), 1000); return () => clearInterval(t); }, []);
            return React.createElement("div", { className: "text-right" },
                React.createElement("div", { className: "text-3xl font-bold font-mono tracking-tight" }, time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })),
                React.createElement("div", { className: "text-xs font-medium text-zinc-500 uppercase" }, time.toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric' }))
            );
        };

        const CompactTimer = () => {
            const [timeLeft, setTimeLeft] = useState(1500);
            const [isActive, setIsActive] = useState(false);
            useEffect(() => { let i; if (isActive && timeLeft > 0) i = setInterval(() => setTimeLeft(t => t - 1), 1000); else if(timeLeft===0) setIsActive(false); return () => clearInterval(i); }, [isActive, timeLeft]);
            const format = (s) => `${Math.floor(s / 60).toString().padStart(2,'0')}:${(s % 60).toString().padStart(2,'0')}`;
            return React.createElement("div", { className: "flex items-center gap-4 bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-xl p-3" },
                React.createElement("div", { className: "font-mono text-2xl font-bold text-indigo-600 dark:text-indigo-400 w-20 text-center" }, format(timeLeft)),
                React.createElement("div", { className: "flex gap-2" },
                    React.createElement("button", { onClick: () => setIsActive(!isActive), className: "p-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 transition-colors" }, 
                        isActive ? React.createElement(Pause, { size: 16 }) : React.createElement(Play, { size: 16 })
                    ),
                    React.createElement("button", { onClick: () => { setIsActive(false); setTimeLeft(1500); }, className: "p-2 rounded-lg bg-zinc-200 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-300 dark:hover:bg-zinc-700 transition-colors" }, 
                        React.createElement(RotateCcw, { size: 16 })
                    )
                )
            );
        };

        // --- VIEWS DEFINITIONS (MUST BE BEFORE APP) ---

        const DashboardView = ({ onNavigate, meals = [], tasks = [], dashboardData, onUpdateDashboard, onAddDump }) => {
            const dailyFocus = dashboardData?.focus || "";
            const [isEditing, setIsEditing] = useState(!dailyFocus);
            const [focusInput, setFocusInput] = useState(dailyFocus);
            const [quickNote, setQuickNote] = useState("");
            const [quote, setQuote] = useState({ text: "Focus is about saying no.", author: "Steve Jobs" });
            
            useEffect(() => {
                if (dailyFocus) {
                    setFocusInput(dailyFocus);
                    setIsEditing(false);
                }
            }, [dailyFocus]);

            const handleSetFocus = () => { if (focusInput.trim()) { onUpdateDashboard({ ...dashboardData, focus: focusInput }); setIsEditing(false); } };
            const handleQuickCapture = () => { if (quickNote.trim()) { onAddDump(quickNote); setQuickNote(""); } };
            const handleEditFocus = () => { setFocusInput(dailyFocus); setIsEditing(true); };

            return React.createElement("div", { className: "animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "mb-8 flex items-end justify-between" },
                    React.createElement("div", null, React.createElement("h2", { className: "text-xl font-bold text-zinc-400 mb-2 uppercase tracking-widest" }, "My Dashboard"), React.createElement(WeatherWidget)),
                    React.createElement(TimeWidget)
                ),
                React.createElement(Card, { title: "Daily Inspiration", className: "mb-8 flex flex-col justify-center bg-gradient-to-br from-white to-zinc-50 dark:from-zinc-900 dark:to-zinc-950" },
                     React.createElement("div", { className: "relative z-10" },
                         React.createElement("div", { className: "absolute -left-2 -top-2 text-6xl text-zinc-100 dark:text-zinc-800 font-serif opacity-50 select-none" }, "“"),
                         React.createElement("blockquote", { className: "text-lg font-medium text-zinc-700 dark:text-zinc-300 mb-4 leading-relaxed relative z-10 pl-2" }, `"${quote.text}"`),
                         React.createElement("cite", { className: "text-xs font-bold text-zinc-400 uppercase tracking-wider block text-right not-italic" }, `— ${quote.author}`)
                     )
                ),
                React.createElement(Card, { className: "mb-8 relative overflow-hidden min-h-[200px] flex flex-col justify-center" },
                    React.createElement("div", { className: "absolute top-0 right-0 w-64 h-64 bg-indigo-500/5 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none" }),
                    React.createElement("div", { className: "relative z-10 w-full" },
                        React.createElement("div", { className: "flex justify-between items-center mb-4" },
                            React.createElement("h3", { className: "text-sm font-semibold text-zinc-500 uppercase tracking-wider flex items-center gap-2" }, React.createElement(Target, { size: 16 }), "Today's Intention"),
                            !isEditing && React.createElement("button", { onClick: handleEditFocus, className: "text-zinc-400 hover:text-indigo-500 p-2" }, React.createElement(Edit3, { size: 16 }))
                        ),
                        isEditing ? (
                            React.createElement("div", { className: "flex gap-2" },
                                React.createElement("input", { type: "text", value: focusInput, onChange: (e) => setFocusInput(e.target.value), onKeyDown: (e) => e.key === 'Enter' && handleSetFocus(), placeholder: "What is your ONE win for today?", className: "w-full bg-transparent border-b-2 border-zinc-200 dark:border-zinc-700 text-3xl font-bold focus:outline-none py-2 text-zinc-900 dark:text-zinc-100" }),
                                React.createElement("button", { onClick: handleSetFocus, disabled: !focusInput.trim(), className: "p-3 bg-indigo-600 text-white rounded-xl" }, React.createElement(ArrowRight, { size: 24 }))
                            )
                        ) : (
                            React.createElement("div", { className: "animate-in fade-in" },
                                React.createElement("p", { className: "text-xs font-medium text-zinc-400 mb-2" }, "TODAY IS A WIN IF I..."),
                                React.createElement("h2", { className: "text-4xl md:text-5xl font-bold text-indigo-600 dark:text-indigo-400 leading-tight" }, dailyFocus)
                            )
                        )
                    )
                ),
                React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-2 gap-6" },
                    React.createElement(Card, { title: "Quick Capture" },
                        React.createElement("div", { className: "flex gap-2" },
                            React.createElement("input", { type: "text", value: quickNote, onChange: (e) => setQuickNote(e.target.value), onKeyDown: (e) => e.key === 'Enter' && handleQuickCapture(), placeholder: "Quick brain dump...", className: "flex-1 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg px-3 py-2 text-sm focus:outline-none text-zinc-900 dark:text-zinc-100" }),
                            React.createElement("button", { onClick: handleQuickCapture, className: "p-2 bg-zinc-200 dark:bg-zinc-800 rounded-lg" }, React.createElement(ArrowRight, { size: 16 }))
                        )
                    ),
                    React.createElement(Card, { title: "Navigation" },
                        React.createElement("div", { className: "flex gap-4" },
                            React.createElement("button", { onClick: () => onNavigate('tasks'), className: "flex-1 p-4 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 rounded-xl font-bold flex flex-col items-center gap-2" }, React.createElement(ListTodo, { size: 24 }), "Tasks"),
                            React.createElement("button", { onClick: () => onNavigate('focus'), className: "flex-1 p-4 bg-rose-50 dark:bg-rose-900/20 text-rose-600 rounded-xl font-bold flex flex-col items-center gap-2" }, React.createElement(Timer, { size: 24 }), "Focus")
                        )
                    )
                )
            );
        };

        const Goals2026View = ({ goalsProgress = {}, onToggleGoal }) => {
            const q1Goals = [
                { id: 'q1_budget', text: "Establish strict yearly budget (Separate from debt)" },
                { id: 'q1_sleep', text: "Keep sleep schedule consistent" },
                { id: 'q1_web', text: "Complete Web Innovation Project" },
                { id: 'q1_diss_log', text: "Complete Dissertation Log 2 & 3" },
                { id: 'q1_ml', text: "Complete Machine Learning Project" },
                { id: 'q1_cyber', text: "Study & Sit for Cyber Security Exam" },
                { id: 'q1_diss_start', text: "Start & Lock-in Dissertation" },
                { id: 'q1_tuition', text: "Pay towards Tuition Fees" },
                { id: 'q1_tenancy', text: "Get someone to take over tenancy for Liverpool apartment" },
                { id: 'q1_workout', text: "Never miss a workout session (4 days weekly)" },
                { id: 'q1_run', text: "Never miss morning run" },
                { id: 'q1_db', text: "Add a database to LifeOS app" },
                { id: 'q1_systems', text: "Master systems (Journal, LifeOS, Calendar, Fitness)" },
                { id: 'q1_bible', text: "Daily Bible & Prayer (Even 1 verse counts)" }
            ];

            const calculatePhaseProgress = (phase) => {
                if (phase === 1) return [goalsProgress.p1_debt, goalsProgress.p1_fees, goalsProgress.p1_cut].filter(Boolean).length / 3 * 100;
                if (phase === 2) return [goalsProgress.p2_sleep, goalsProgress.p2_spirit, goalsProgress.p2_work].filter(Boolean).length / 3 * 100;
                if (phase === 3) return [goalsProgress.p3_skill, goalsProgress.p3_project, goalsProgress.p3_career].filter(Boolean).length / 3 * 100;
                return 0;
            };

            return React.createElement("div", { className: "h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500 pb-24 md:pb-0" },
                React.createElement("div", { className: "flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4" },
                    React.createElement("div", null, React.createElement("h3", { className: "text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2" }, "2026 Master Plan ", React.createElement("span", { className: "px-2 py-0.5 rounded-full bg-rose-100 dark:bg-rose-900/30 text-rose-600 dark:text-rose-400 text-xs font-bold uppercase tracking-wider flex items-center gap-1" }, React.createElement(Flag, { size: 12 }), " Vision")), React.createElement("p", { className: "text-zinc-500 text-sm mt-1" }, "Stability → Discipline → Direction")),
                ),
                React.createElement("div", { className: "space-y-8 pb-12 overflow-y-auto pr-2" },
                    React.createElement(Card, { className: "bg-gradient-to-br from-indigo-600 to-indigo-800 text-white border-none" },
                        React.createElement("div", { className: "flex flex-col h-full justify-between" },
                            React.createElement("div", null, React.createElement("div", { className: "flex items-center gap-2 text-indigo-200 text-xs font-bold uppercase tracking-wider mb-2" }, React.createElement(Target, { size: 14 }), " Primary Mission"), React.createElement("h4", { className: "text-lg font-bold leading-snug" }, "Build a life of Stability, Discipline, and Purpose, grounded in the Word of God.")),
                            React.createElement("div", { className: "mt-4 pt-4 border-t border-indigo-400/30" }, React.createElement("p", { className: "text-xs text-indigo-100 italic" }, "“I am questioning everything to build a future on solid rock.”"))
                        )
                    ),
                    React.createElement("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-6" },
                        React.createElement("div", { className: "bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-2xl p-6" },
                            React.createElement("div", { className: "absolute -top-3 left-6 px-3 py-1 bg-rose-500 text-white text-[10px] font-bold uppercase tracking-widest rounded-full" }, "Phase 1: Stabilise"),
                            React.createElement("h4", { className: "text-lg font-bold mt-4" }, "Financial Security"),
                            React.createElement("div", { className: "space-y-3 mt-4" },
                                React.createElement("button", { onClick: () => onToggleGoal('p1_debt'), className: "flex items-center gap-3 w-full text-left" }, React.createElement("div", { className: `w-5 h-5 rounded border flex items-center justify-center ${goalsProgress.p1_debt ? 'bg-rose-500' : ''}` }, React.createElement(CheckCircle2, { size: 14 })), "Clear Debt"),
                                React.createElement("button", { onClick: () => onToggleGoal('p1_fees'), className: "flex items-center gap-3 w-full text-left" }, React.createElement("div", { className: `w-5 h-5 rounded border flex items-center justify-center ${goalsProgress.p1_fees ? 'bg-rose-500' : ''}` }, React.createElement(CheckCircle2, { size: 14 })), "Pay Fees")
                            ),
                            React.createElement("div", { className: "mt-4 h-1 w-full bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden" }, React.createElement("div", { className: "h-full bg-rose-500 transition-all duration-500", style: { width: `${calculatePhaseProgress(1)}%` } }))
                        )
                    ),
                    React.createElement(Card, { title: "Q1: The Foundation (Jan - Mar)", className: "border-t-4 border-t-rose-500 bg-rose-50/10" },
                        React.createElement("div", { className: "space-y-2" },
                            q1Goals.map((goal) => 
                                React.createElement("button", { key: goal.id, onClick: () => onToggleGoal(goal.id), className: "flex items-start gap-3 w-full text-left group" },
                                    React.createElement("div", { className: `mt-0.5 w-5 h-5 rounded border flex items-center justify-center transition-all shrink-0 ${goalsProgress[goal.id] ? 'bg-rose-500 border-rose-500 text-white' : 'border-zinc-400 bg-white dark:bg-zinc-800'}` }, React.createElement(CheckCircle2, { size: 14, className: goalsProgress[goal.id] ? "opacity-100" : "opacity-0" })),
                                    React.createElement("span", { className: `text-sm leading-snug ${goalsProgress[goal.id] ? 'text-zinc-400 line-through' : 'text-zinc-800 dark:text-zinc-200'}` }, goal.text)
                                )
                            )
                        )
                    )
                )
            );
        };

        const TasksView = ({ tasks, onAddTask, onUpdateTask, onDeleteTask }) => {
            const [newTaskInput, setNewTaskInput] = useState("");
            const handleKeyDown = (e) => { if (e.key === 'Enter' && newTaskInput.trim()) { onAddTask({ text: newTaskInput, category: 'do_first', completed: false }); setNewTaskInput(""); } };
            const quadrants = [{ id: 'do_first', title: 'Do First', color: 'bg-red-50 dark:bg-red-900/10' }, { id: 'schedule', title: 'Schedule', color: 'bg-blue-50 dark:bg-blue-900/10' }, { id: 'delegate', title: 'Delegate', color: 'bg-orange-50 dark:bg-orange-900/10' }, { id: 'dont_do', title: 'Eliminate', color: 'bg-zinc-50 dark:bg-zinc-900/50' }];
            const onDrop = (e, cat) => { e.preventDefault(); const id = e.dataTransfer.getData("id"); onUpdateTask(id, { category: cat }); };

            return React.createElement("div", { className: "h-full flex flex-col pb-24 md:pb-0" },
                React.createElement("div", { className: "mb-6 flex gap-4" },
                    React.createElement("input", { type: "text", value: newTaskInput, onChange: (e) => setNewTaskInput(e.target.value), onKeyDown: handleKeyDown, placeholder: "Add task...", className: "flex-1 p-2 rounded-xl border bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100" }),
                    React.createElement("button", { onClick: () => { if(newTaskInput.trim()){ onAddTask({text:newTaskInput, category:'do_first'}); setNewTaskInput("");}}, className: "p-2 bg-indigo-600 text-white rounded-xl" }, React.createElement(Plus, { size: 20 }))
                ),
                React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-4 flex-1 overflow-y-auto" },
                    quadrants.map(q => React.createElement("div", { key: q.id, onDragOver: e=>e.preventDefault(), onDrop: e=>onDrop(e, q.id), className: `p-4 rounded-xl ${q.color} border` },
                        React.createElement("h4", { className: "font-bold mb-4" }, q.title),
                        tasks.filter(t => t.category === q.id).map(t => React.createElement("div", { key: t.id, draggable: true, onDragStart: e=>e.dataTransfer.setData("id", t.id), className: "flex gap-2 p-2 bg-white dark:bg-zinc-900 rounded mb-2 shadow-sm" },
                            React.createElement("button", { onClick: () => onUpdateTask(t.id, { completed: !t.completed }) }, React.createElement(CheckCircle2, { size: 16, className: t.completed ? "text-green-500" : "text-gray-400" })),
                            React.createElement("span", { className: t.completed ? "line-through text-gray-400" : "" }, t.text),
                            React.createElement("button", { onClick: () => onDeleteTask(t.id), className: "ml-auto text-red-400" }, React.createElement(Trash, { size: 14 }))
                        ))
                    ))
                )
            );
        };

        const WorriesView = ({ worries, onAddWorry, onDeleteWorry }) => {
            const [input, setInput] = useState("");
            return React.createElement("div", { className: "h-full flex flex-col pb-24 md:pb-0" },
                React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "Worry Jar"),
                React.createElement("div", { className: "flex-1 overflow-y-auto space-y-4 mb-4" },
                    worries.map(w => React.createElement("div", { key: w.id, className: "p-4 bg-white dark:bg-zinc-900 rounded-xl border flex justify-between" }, 
                        React.createElement("span", null, w.text),
                        React.createElement("button", { onClick: () => onDeleteWorry(w.id), className: "text-red-500" }, "Let Go")
                    ))
                ),
                React.createElement("div", { className: "flex gap-2" },
                    React.createElement("input", { value: input, onChange: e => setInput(e.target.value), className: "flex-1 p-3 rounded-xl border bg-white dark:bg-zinc-900 text-zinc-900 dark:text-zinc-100" }),
                    React.createElement("button", { onClick: () => { if(input.trim()) { onAddWorry(input); setInput(""); }}, className: "p-3 bg-indigo-600 text-white rounded-xl" }, "Cast")
                )
            );
        };

        const FocusView = ({ activeSound, isPlayingSound, toggleSound }) => {
            const [timeLeft, setTimeLeft] = useState(1500);
            const [isActive, setIsActive] = useState(false);
            useEffect(() => { let i; if (isActive && timeLeft > 0) i = setInterval(() => setTimeLeft(t => t - 1), 1000); else if(timeLeft===0) setIsActive(false); return () => clearInterval(i); }, [isActive, timeLeft]);
            
            return React.createElement("div", { className: "h-full flex flex-col items-center justify-center pb-24" },
                React.createElement("div", { className: "text-8xl font-mono font-bold mb-8" }, `${Math.floor(timeLeft/60)}:${(timeLeft%60).toString().padStart(2,'0')}`),
                React.createElement("div", { className: "flex gap-4 mb-12" },
                    React.createElement("button", { onClick: () => setIsActive(!isActive), className: "px-8 py-4 bg-indigo-600 text-white rounded-2xl font-bold text-xl" }, isActive ? "PAUSE" : "START"),
                    React.createElement("button", { onClick: () => { setIsActive(false); setTimeLeft(1500); }, className: "px-8 py-4 bg-zinc-200 text-zinc-800 rounded-2xl font-bold text-xl" }, "RESET")
                ),
                React.createElement("div", { className: "grid grid-cols-4 gap-4" },
                    FOCUS_SOUNDS.map(s => React.createElement("button", { key: s.id, onClick: () => toggleSound(s), className: `p-4 rounded-xl border ${activeSound === s.id && isPlayingSound ? 'bg-indigo-100 border-indigo-500' : 'bg-white border-zinc-200'}` }, 
                        React.createElement(s.icon, { size: 24, className: "mx-auto mb-2" }), s.label
                    ))
                )
            );
        };

        const BrainDumpView = ({ dumps, onAddDump, onDeleteDump }) => {
            const [input, setInput] = useState("");
            return React.createElement("div", { className: "h-full flex flex-col pb-24" },
                React.createElement("h3", { className: "text-2xl font-bold mb-4" }, "Brain Dump"),
                React.createElement("div", { className: "flex-1 overflow-y-auto space-y-4 mb-4" },
                    dumps.map(d => React.createElement("div", { key: d.id, className: "p-4 bg-white dark:bg-zinc-900 rounded-xl border relative group" }, 
                        React.createElement("p", { className: "whitespace-pre-wrap" }, d.text),
                        React.createElement("button", { onClick: () => onDeleteDump(d.id), className: "absolute top-4 right-4 text-red-500 opacity-0 group-hover:opacity-100" }, React.createElement(Trash, { size: 16 }))
                    ))
                ),
                React.createElement("textarea", { value: input, onChange: e => setInput(e.target.value), onKeyDown: e => { if(e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); onAddDump(input); setInput(""); }}, className: "w-full p-4 rounded-xl border bg-white dark:bg-zinc-900 h-32 text-zinc-900 dark:text-zinc-100", placeholder: "Type here..." })
            );
        };

        const SpiritualityView = () => React.createElement("div", { className: "p-4" }, "Spirituality Content Placeholder");
        const FitnessView = () => React.createElement("div", { className: "p-4" }, "Fitness Content Placeholder");
        
        const FoodView = ({ meals, onUpdateMeal }) => {
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            const types = ['Breakfast', 'Lunch', 'Dinner', 'Snack'];
            const [viewMode, setViewMode] = useState('day');
            const todayIndex = (new Date().getDay() + 6) % 7;
            const [activeDayIndex, setActiveDayIndex] = useState(todayIndex);

            const getMeal = (day, type) => {
                const userMeal = meals.find(m => m.day === day && m.type === type);
                if (userMeal) return userMeal.text;
                const defaultMeal = DEFAULT_MEALS.find(m => m.day === day && m.type === type);
                return defaultMeal ? defaultMeal.text : "";
            };

            return React.createElement("div", { className: "h-full flex flex-col pb-24 md:pb-0" },
                React.createElement("div", { className: "flex justify-between items-center mb-6" },
                    React.createElement("h3", { className: "text-2xl font-bold" }, "Nutrition"),
                    React.createElement("div", { className: "flex p-1 bg-zinc-100 dark:bg-zinc-800 rounded-lg" },
                        React.createElement("button", { onClick: () => setViewMode('day'), className: `px-4 py-1.5 rounded ${viewMode === 'day' ? 'bg-white shadow' : ''}` }, "Day"),
                        React.createElement("button", { onClick: () => setViewMode('week'), className: `px-4 py-1.5 rounded ${viewMode === 'week' ? 'bg-white shadow' : ''}` }, "Week")
                    )
                ),
                viewMode === 'day' ? (
                    React.createElement("div", { className: "flex-1 overflow-y-auto" },
                        React.createElement("div", { className: "flex items-center justify-between mb-6 p-3 rounded-xl border bg-white dark:bg-zinc-900" },
                            React.createElement("button", { onClick: () => setActiveDayIndex((prev) => (prev - 1 + 7) % 7) }, React.createElement(ChevronLeft, { size: 20 })),
                            React.createElement("span", { className: "font-bold" }, days[activeDayIndex]),
                            React.createElement("button", { onClick: () => setActiveDayIndex((prev) => (prev + 1) % 7) }, React.createElement(ChevronRight, { size: 20 }))
                        ),
                        React.createElement("div", { className: "grid gap-4" },
                            types.map(type => React.createElement("div", { key: type, className: "p-4 rounded-xl border bg-white dark:bg-zinc-900" },
                                React.createElement("div", { className: "font-bold text-xs uppercase text-zinc-500 mb-2" }, type),
                                React.createElement("textarea", { value: getMeal(days[activeDayIndex], type), onChange: (e) => onUpdateMeal(days[activeDayIndex], type, e.target.value), className: "w-full bg-transparent resize-none focus:outline-none text-zinc-900 dark:text-zinc-100" })
                            ))
                        )
                    )
                ) : (
                    React.createElement("div", { className: "flex-1 overflow-y-auto space-y-6" },
                        days.map(day => React.createElement("div", { key: day, className: "border rounded-xl bg-white dark:bg-zinc-900 overflow-hidden" },
                            React.createElement("div", { className: "p-3 bg-zinc-50 dark:bg-zinc-950 font-bold border-b" }, day),
                            React.createElement("div", { className: "grid grid-cols-2 divide-x divide-y" },
                                types.map(type => React.createElement("div", { key: type, className: "p-3" },
                                    React.createElement("div", { className: "text-xs font-bold text-zinc-500 mb-1" }, type),
                                    React.createElement("textarea", { value: getMeal(day, type), onChange: (e) => onUpdateMeal(day, type, e.target.value), className: "w-full bg-transparent resize-none text-sm focus:outline-none text-zinc-900 dark:text-zinc-100", rows: 2 })
                                ))
                            )
                        ))
                    )
                )
            );
        };
        
        const ToolsView = () => React.createElement("div", { className: "p-4" }, "Tools Content Placeholder");

        // --- APP COMPONENT ---

        const App = () => {
            const VALID_TABS = ['dashboard', 'goals2026', 'tasks', 'focus', 'braindump', 'spirituality', 'food', 'fitness', 'tools', 'worries'];
            const [activeTab, setActiveTab] = useState(() => localStorage.getItem('lifeos_active_tab') || 'dashboard');
            const [darkMode, setDarkMode] = useState(() => JSON.parse(localStorage.getItem('lifeos_dark_mode') || 'true'));
            
            // Session Persistence
            const [user, setUser] = useState(() => {
                const stored = localStorage.getItem('lifeos_user_session');
                return stored ? JSON.parse(stored) : null;
            });
            
            // Safety Flag
            const [isDataLoaded, setIsDataLoaded] = useState(false);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [showShareModal, setShowShareModal] = useState(false);
            const [showAuthModal, setShowAuthModal] = useState(false);
            const [authError, setAuthError] = useState(null);

            const [dumps, setDumps] = useState([]);
            const [meals, setMeals] = useState([]);
            const [worries, setWorries] = useState([]);
            const [tasks, setTasks] = useState([]);
            const [goalsProgress, setGoalsProgress] = useState({});
            const [dashboardData, setDashboardData] = useState({ focus: "", habits: [] });
            const [activeSound, setActiveSound] = useState(null);
            const [isPlayingSound, setIsPlayingSound] = useState(false);
            const audioRef = useRef(new Audio());

            // Auth Listener - ONLY for initial check, does not force logout if local
            useEffect(() => {
                if (isFirebaseConfigured) {
                    const unsubscribe = onAuthStateChanged(auth, (u) => {
                        // Only auto-update if cloud login happens and we aren't already locally logged in
                        if (u && (!user || !user.isLocal)) {
                             const newUser = { email: u.email || "Guest", uid: u.uid, isLocal: false };
                             setUser(newUser);
                             localStorage.setItem('lifeos_user_session', JSON.stringify(newUser));
                        }
                    });
                    return () => unsubscribe();
                }
            }, []);

            // Handle Manual Login Success
            const handleLoginSuccess = (userData) => {
                setUser(userData);
                localStorage.setItem('lifeos_user_session', JSON.stringify(userData));
                setIsDataLoaded(false); // Trigger data load for new user
            };

            const handleLogout = () => {
                if (isFirebaseConfigured && auth.currentUser) signOut(auth);
                setUser(null);
                localStorage.removeItem('lifeos_user_session');
                setIsDataLoaded(false);
                setDumps([]); setMeals([]); setTasks([]); setWorries([]); setGoalsProgress({}); setDashboardData({ focus: "", habits: [] });
            };

            // Data Sync - Multi-Tenant (Local vs Cloud)
            useEffect(() => {
                if (!user) return;

                if (!user.isLocal && isFirebaseConfigured) {
                    // Cloud Mode
                    const userId = user.uid;
                    const unsubDumps = onSnapshot(query(collection(db, 'artifacts', appId, 'users', userId, 'brain_dumps'), orderBy('createdAt', 'desc')), s => setDumps(s.docs.map(d => ({id:d.id, ...d.data()}))));
                    const unsubMeals = onSnapshot(query(collection(db, 'artifacts', appId, 'users', userId, 'meals')), s => setMeals(s.docs.map(d => ({id:d.id, ...d.data()}))));
                    const unsubTasks = onSnapshot(query(collection(db, 'artifacts', appId, 'users', userId, 'tasks'), orderBy('createdAt', 'desc')), s => setTasks(s.docs.map(d => ({id:d.id, ...d.data()}))));
                    const unsubWorries = onSnapshot(query(collection(db, 'artifacts', appId, 'users', userId, 'worries'), orderBy('createdAt', 'desc')), s => setWorries(s.docs.map(d => ({id:d.id, ...d.data()}))));
                    const unsubGoals = onSnapshot(doc(db, 'artifacts', appId, 'users', userId, 'goals', 'progress_2026'), s => { if(s.exists()) setGoalsProgress(s.data()); });
                    const unsubDash = onSnapshot(doc(db, 'artifacts', appId, 'users', userId, 'dashboard', 'daily_data'), s => { 
                        if(s.exists()) setDashboardData(s.data()); 
                        setIsDataLoaded(true); 
                    });
                    return () => { unsubDumps(); unsubMeals(); unsubTasks(); unsubWorries(); unsubGoals(); unsubDash(); };
                } else {
                    // Local Mode - Namespaced by User ID
                    const prefix = `lifeos_data_${user.uid}_`;
                    try {
                        setDumps(JSON.parse(localStorage.getItem(`${prefix}dumps`) || '[]'));
                        setMeals(JSON.parse(localStorage.getItem(`${prefix}meals`) || '[]'));
                        setTasks(JSON.parse(localStorage.getItem(`${prefix}tasks`) || '[]'));
                        setWorries(JSON.parse(localStorage.getItem(`${prefix}worries`) || '[]'));
                        setGoalsProgress(JSON.parse(localStorage.getItem(`${prefix}goals_2026`) || '{}'));
                        setDashboardData(JSON.parse(localStorage.getItem(`${prefix}dashboard`) || '{"focus":"", "habits":[]}'));
                        setIsDataLoaded(true);
                    } catch(e) { console.error("Local Load Error", e); }
                }
            }, [user]);

            // Save to LocalStorage (Only for Local Users AND only if data has loaded)
            useEffect(() => {
                if (user?.isLocal && isDataLoaded) {
                    const prefix = `lifeos_data_${user.uid}_`;
                    localStorage.setItem(`${prefix}dumps`, JSON.stringify(dumps));
                    localStorage.setItem(`${prefix}meals`, JSON.stringify(meals));
                    localStorage.setItem(`${prefix}tasks`, JSON.stringify(tasks));
                    localStorage.setItem(`${prefix}worries`, JSON.stringify(worries));
                    localStorage.setItem(`${prefix}goals_2026`, JSON.stringify(goalsProgress));
                    localStorage.setItem(`${prefix}dashboard`, JSON.stringify(dashboardData));
                }
            }, [dumps, meals, tasks, worries, goalsProgress, dashboardData, user, isDataLoaded]);

            // Handlers
            const handleAddDump = async (text) => {
                const newDump = { id: Date.now().toString(), text, createdAt: new Date() };
                setDumps(prev => [newDump, ...prev]);
                if (user && !user.isLocal) await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'brain_dumps'), { text, createdAt: serverTimestamp() });
            };
            const handleDeleteDump = async (id) => {
                setDumps(prev => prev.filter(d => d.id !== id));
                if (user && !user.isLocal) await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'brain_dumps', id));
            };
            const handleAddWorry = async (text) => {
                const newWorry = { id: Date.now().toString(), text, createdAt: new Date() };
                setWorries(prev => [newWorry, ...prev]);
                if (user && !user.isLocal) await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'worries'), { text, createdAt: serverTimestamp() });
            };
            const handleDeleteWorry = async (id) => {
                setWorries(prev => prev.filter(w => w.id !== id));
                if (user && !user.isLocal) await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'worries', id));
            };
            const handleAddTask = async (task) => {
                const newTask = { id: Date.now().toString(), ...task, createdAt: new Date() };
                setTasks(prev => [newTask, ...prev]);
                if (user && !user.isLocal) await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'tasks'), { ...task, createdAt: serverTimestamp() });
            };
            const handleUpdateTask = async (id, data) => {
                setTasks(prev => prev.map(t => t.id === id ? { ...t, ...data } : t));
                if (user && !user.isLocal) await updateDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'tasks', id), data);
            };
            const handleDeleteTask = async (id) => {
                setTasks(prev => prev.filter(t => t.id !== id));
                if (user && !user.isLocal) await deleteDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'tasks', id));
            };
            const handleUpdateDashboard = async (data) => {
                setDashboardData(data);
                if (user && !user.isLocal) await setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'dashboard', 'daily_data'), data, { merge: true });
            };
            const handleToggleGoal = async (id) => {
                const newProg = { ...goalsProgress, [id]: !goalsProgress[id] };
                setGoalsProgress(newProg);
                if (user && !user.isLocal) await setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'goals', 'progress_2026'), newProg, { merge: true });
            };
            
            const handleUpdateMeal = async (day, type, text) => {
                const existingMeal = meals.find(m => m.day === day && m.type === type);
                // Optimistic update
                if (existingMeal) { setMeals(prev => prev.map(m => m.id === existingMeal.id ? { ...m, text } : m)); } else { setMeals(prev => [...prev, { id: Date.now(), day, type, text }]); }
                
                if (user && !user.isLocal) {
                    if (existingMeal) { await updateDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'meals', existingMeal.id), { text }); }
                    else { await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'meals'), { day, type, text }); }
                }
            };

            const toggleSound = (sound) => {
                if (activeSound === sound.id && isPlayingSound) { audioRef.current.pause(); setIsPlayingSound(false); }
                else { audioRef.current.src = sound.url; audioRef.current.loop = true; audioRef.current.play(); setIsPlayingSound(true); setActiveSound(sound.id); }
            };

            // Effects
            useEffect(() => { if (darkMode) document.documentElement.classList.add('dark'); else document.documentElement.classList.remove('dark'); }, [darkMode]);
            useEffect(() => localStorage.setItem('lifeos_active_tab', activeTab), [activeTab]);

            if (!user) return React.createElement(LandingPage, { 
                onLoginSuccess: handleLoginSuccess, 
                onGuestLogin: handleLoginSuccess 
            });

            return React.createElement("div", { className: "min-h-screen bg-zinc-50 dark:bg-zinc-950 text-zinc-900 dark:text-zinc-100 font-sans" },
                React.createElement("aside", { className: "fixed left-0 top-0 h-full w-64 border-r border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-950 p-6 hidden md:flex flex-col z-20" },
                    React.createElement("h1", { className: "text-2xl font-bold mb-8" }, "LifeOS"),
                    React.createElement("nav", { className: "space-y-2 flex-1" },
                        VALID_TABS.map(t => React.createElement(NavItem, { key: t, icon: Layout, label: t.charAt(0).toUpperCase() + t.slice(1), active: activeTab === t, onClick: () => setActiveTab(t) }))
                    ),
                    React.createElement("div", { className: "pt-6 border-t border-zinc-200 dark:border-zinc-800 space-y-2" },
                        React.createElement("button", { onClick: () => setDarkMode(!darkMode), className: "w-full flex items-center gap-3 px-4 py-3 rounded-xl text-zinc-500 hover:bg-zinc-100 dark:text-zinc-400 dark:hover:bg-zinc-800 transition-colors" },
                            React.createElement(darkMode ? Sun : Moon, { size: 20 }),
                            React.createElement("span", { className: "font-medium" }, darkMode ? "Light Mode" : "Dark Mode")
                        ),
                        React.createElement("button", { onClick: handleLogout, className: "w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 transition-colors" },
                            React.createElement(LogOut, { size: 20 }),
                            React.createElement("span", { className: "font-medium" }, "Sign Out")
                        )
                    )
                ),
                mobileMenuOpen && React.createElement("div", { className: "fixed inset-0 z-50 md:hidden" },
                    React.createElement("div", { className: "absolute inset-0 bg-black/50 backdrop-blur-sm", onClick: () => setMobileMenuOpen(false) }),
                    React.createElement("aside", { className: "absolute left-0 top-0 h-full w-64 bg-white dark:bg-zinc-950 border-r border-zinc-200 dark:border-zinc-800 p-6 flex flex-col shadow-2xl animate-in slide-in-from-left duration-300" }, 
                        React.createElement("h1", { className: "text-2xl font-bold mb-8" }, "LifeOS"),
                        React.createElement("nav", { className: "space-y-2 flex-1" }, VALID_TABS.map(t => React.createElement(NavItem, { key: t, icon: Layout, label: t.charAt(0).toUpperCase() + t.slice(1), active: activeTab === t, onClick: () => { setActiveTab(t); setMobileMenuOpen(false); } }))),
                        React.createElement("button", { onClick: handleLogout, className: "w-full flex items-center gap-3 px-4 py-3 rounded-xl text-red-500" }, React.createElement(LogOut, { size: 20 }), "Sign Out")
                    )
                ),
                React.createElement("main", { className: "md:ml-64 p-4 md:p-12 max-w-7xl mx-auto" },
                    showAuthModal && React.createElement(AuthModal, { onClose: () => setShowAuthModal(false), onLogin: handleLoginSuccess }),
                    activeTab === 'dashboard' && React.createElement(DashboardView, { onAddDump: handleAddDump, dashboardData, onUpdateDashboard: handleUpdateDashboard, onNavigate: setActiveTab }),
                    activeTab === 'goals2026' && React.createElement(Goals2026View, { goalsProgress, onToggleGoal: handleToggleGoal }),
                    activeTab === 'tasks' && React.createElement(TasksView, { tasks, onAddTask: handleAddTask, onUpdateTask: handleUpdateTask, onDeleteTask: handleDeleteTask }),
                    activeTab === 'worries' && React.createElement(WorriesView, { worries, onAddWorry: handleAddWorry, onDeleteWorry: handleDeleteWorry }),
                    activeTab === 'focus' && React.createElement(FocusView, { activeSound, isPlayingSound, toggleSound }),
                    activeTab === 'braindump' && React.createElement(BrainDumpView, { dumps, onAddDump: handleAddDump, onDeleteDump: handleDeleteDump }),
                    activeTab === 'spirituality' && React.createElement(SpiritualityView),
                    activeTab === 'fitness' && React.createElement(FitnessView),
                    activeTab === 'food' && React.createElement(FoodView, { meals, onUpdateMeal: handleUpdateMeal }),
                    activeTab === 'tools' && React.createElement(ToolsView)
                )
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>
